function o(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,o),e.l=!0,e.exports}var n,r;r={},o.m=n=[function(t,e,n){},function(t,e,n){"use strict";function r(a){var u={},s={},n=Object.create(a);for(var t in a.__getCallID=function(t){var e=(new Error).stack;if(e){var n=e.split(/\n/g),r=!1,o=0;for(var i in t++,n){if(o===t)return n[i];!r&&n[i].match(/getCallID/)&&(r=!0),r&&o++}}return"exception"},a)!function(t,i){n[i]=function(){var t=this.__id,e=s[t]||0,n=+new Date;if(n-e>=this.__throttle){s[t]=n;var r=u[t]||0;if(r<this.__limit){u[t]=r+1;var o=a[i].consoleExtras?this:a;a[i].apply(o,arguments)}}return this}}(a[t],t);return a.times=function(t){var e=Object.create(n);return e.__id=this.__id||a.__getCallID(1),e.__limit=t,e.__throttle=this.__throttle||0,e},a.times.consoleExtras=!0,a.throttle=function(t){var e=Object.create(n);return e.__id=this.__id||a.__getCallID(1),e.__limit=this.__limit||1/0,e.__throttle=t,e},a.throttle.consoleExtras=!0,a}function y(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.r(e),n(0);var i=r(window.console),a=function(){function e(t){!function(t){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this._delta=0,this._previousTimestamp=0,this._updateTime=0,this._updateTimeStep=t.updateTimeStep||10,this._updateTimeMax=t.updateTimeMax||50,this.world=t.world,this.fps=0,this.debug=t.debug||!1}return o(e.prototype,[{key:"run",value:function(){var e=this;return Promise.all(this.load()).then(function(t){e.init(t),window.requestAnimationFrame(e.tick.bind(e))})}},{key:"tick",value:function(t){for(t|=0,this._delta=t-this._previousTimestamp,this._previousTimestamp=t,this._updateTime+=this._delta,this._updateTime>this._updateTimeMax&&(this.debug&&i.throttle(1e3).warn("[ENGINE] update time above threshold ".concat(this._updateTime,", clamping to ").concat(this._updateTimeMax)),this._updateTime=this._updateTimeMax),this.fps=1e3/this._delta|0;this._updateTime>=this._updateTimeStep;)this.update(this._updateTimeStep,t),this._updateTime-=this._updateTimeStep,t+=this._updateTimeStep;this.render(),window.requestAnimationFrame(this.tick.bind(this))}},{key:"load",value:function(){return this.world.load()}},{key:"init",value:function(t){this.world.init()}},{key:"update",value:function(t,e){this.world.update(t,e)}},{key:"render",value:function(){this.world.draw(),2<this.debug&&this._drawCellNumbers(),1<this.debug&&this._drawGrid(),this.debug&&this._drawDebug()}},{key:"_drawGrid",value:function(){var t=this.world.viewport.context,e=this.world.tilesets[0].tileSize,n=0,r=0,o=0,i=y(this.world.viewport.getRect(e),4),a=i[0],u=i[1],s=i[2],l=i[3];t.strokeStyle="black";for(var c=a*e-this.world.viewport.offsetX,f=s*e-this.world.viewport.offsetY,h=a;h<=u;h++)for(o=s;o<=l;o++)n=(h-a)*e+c,r=(o-s)*e+f,t.strokeRect(0|n,0|r,e,e)}},{key:"_drawCellNumbers",value:function(){var t=this.world.viewport.context,e=this.world.tilesets[0].tileSize,n=this.world.layers[0].getSize()[0],r=y(this.world.viewport.getRect(e),4),o=r[0],i=r[1],a=r[2],u=r[3],s=o*e-this.world.viewport.offsetX,l=a*e-this.world.viewport.offsetY,c=0,f=0,h=0,d=0;t.fillStyle="black",t.font="16px sans-serif";for(var p=a;p<=u;p++)for(h=o;h<=i;h++)c=(h-o)*e+s+e/8,f=(p-a)*e+l+e/2,d=p*n+(h+1),t.fillText("[ ".concat(d," (").concat(h+" | "+p,") ]"),0|c,0|f,3*e/4)}},{key:"_drawDebug",value:function(){var t=this.world.viewport.context;t.fillStyle="black",t.fillRect(10,10,80,40),t.fillStyle="white",t.fillText("FPS: ".concat(this.fps),15,25),t.fillText("Î”: ".concat(this._delta,"ms"),15,45)}}]),e}();function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=function(){function e(){!function(t){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this._eventHandlers=new Map}return u(e.prototype,[{key:"on",value:function(t,e,n){return this._eventHandlers.has(t)||this._eventHandlers.set(t,[]),this._eventHandlers.get(t).push({callback:e,this:n}),this}},{key:"off",value:function(t,e,n){var r=this._eventHandlers.get(t);if(r&&r.length){var o=r.findIndex(function(t){return t.callback===e&&t.this===n});if(-1<o)return r.splice(o,1),!0}return!1}},{key:"emit",value:function(t){for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var o=this._eventHandlers.get(t);return!(!o||!o.length)&&o.reduce(function(t,e){return e.callback.apply(e.this,n),++t},0)}}]),e}();function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,n){return e&&f(t.prototype,e),n&&f(t,n),t}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var p=function(){function n(t){var e;return function(t){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this),(e=function(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?function(){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():e}(this,c(n).call(this))).id=t.id,e.name=t.name,e.component=t.component,e._state={},e._closed=!0,e.debug=t.debug||!1,e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(n,s),h(n,null,[{key:"info",value:function(){}}]),h(n,[{key:"getState",value:function(){return this._state}},{key:"setState",value:function(t){Object.assign(this._state,t)}},{key:"open",value:function(t,e){return this.setState(e),this._attachHandlers(t),t.classList.remove("hide"),!(this._closed=!1)}},{key:"update",value:function(t){return!0}},{key:"close",value:function(t){return this._detachHandlers(t),t.classList.add("hide"),this._closed=!0,this.getState()}},{key:"isOpen",value:function(){return!this._closed}},{key:"_attachHandlers",value:function(t){}},{key:"_detachHandlers",value:function(t){}}]),n}();function v(t){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function m(t,e,n){return(m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _(t,e,n){return e&&w(t.prototype,e),n&&w(t,n),t}function k(t,e){return(k=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var O=function(){function n(t){var e;return function(t){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this),(e=function(t,e){return!e||"object"!==v(e)&&"function"!=typeof e?function(){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():e}(this,g(n).call(this,t))).cost=t.cost,e.production=t.production,e.time=1e3*t.time,e.icon=t.icon,e.begin=Date.now(),e.end=e.begin+e.time,e._previousTimestamp=0,e.paused=!1,e.workers=0,e.maxWorkers=t.maxWorkers||0,e.pause(),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&k(t,e)}(n,p),_(n,null,[{key:"info",value:function(){}}]),_(n,[{key:"getState",value:function(){return function(o){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?b(i,!0).forEach(function(t){var e,n,r;e=o,r=i[n=t],n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(i)):b(i).forEach(function(t){Object.defineProperty(o,t,Object.getOwnPropertyDescriptor(i,t))})}return o}({},m(g(n.prototype),"getState",this).call(this),{workers:this.workers,begin:this.begin,end:this.end,previousTimestamp:this._previousTimestamp,paused:this.paused})}},{key:"setState",value:function(t){m(g(n.prototype),"setState",this).call(this,t),this.workers=t.workers||this.workers,this.begin=t.begin||this.begin,this.end=t.end||this.end,this._previousTimestamp=t.previousTimestamp||this._previousTimestamp,this.paused=t.paused||this.paused}},{key:"reset",value:function(t){var e=0<arguments.length&&void 0!==t&&t;this.begin=Date.now(),this.end=this.begin+this.time,this.paused=!!e&&this.begin}},{key:"pause",value:function(){this.paused||(this.paused=Date.now())}},{key:"resume",value:function(){this.paused&&(this.end+=Date.now()-this.paused,this.paused=!1)}},{key:"produce",value:function(t){return 0===this._previousTimestamp&&(this._previousTimestamp=t),!this.paused&&0<this.workers&&this.begin+(t-this._previousTimestamp)>this.end&&(this.reset(),this._previousTimestamp=t,this.production)}},{key:"getCost",value:function(){return this.cost}},{key:"assignWorker",value:function(){return this.workers<this.maxWorkers&&(0===this.workers&&this.resume(),this.workers++,!0)}},{key:"removeWorker",value:function(){return 0<this.workers&&(this.workers--,0===this.workers&&this.pause(),!0)}}]),n}();function S(t){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function T(t,e,n){return(T="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=E(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function E(t){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function j(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function P(t,e,n){return e&&j(t.prototype,e),n&&j(t,n),t}function x(t,e){return(x=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var C=function(){function n(t){!function(t){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this);var e=JSON.parse(JSON.stringify(n.info()));return function(t,e){return!e||"object"!==S(e)&&"function"!=typeof e?function(){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():e}(this,E(n).call(this,Object.assign(e,t)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&x(t,e)}(n,O),P(n,null,[{key:"info",value:function(){return{id:112,name:"Field",component:"building-panel",cost:{food:10,wood:20},production:{food:50},time:10,maxWorkers:1,icon:{image:"/static/tileset.png",x:-384,y:-768}}}}]),P(n,[{key:"open",value:function(t,e){return t.update({name:this.name,picture:"",description:"A farming field to produce food for your population",information:["produces 50 food"],abilities:[],workers:this.workers,maxWorkers:this.maxWorkers}),T(E(n.prototype),"open",this).call(this,t,e)}},{key:"update",value:function(t){return t.update({name:this.name,picture:"",description:"A farming field to produce food for your population",information:["produces 50 food"],abilities:[],workers:this.workers,maxWorkers:this.maxWorkers}),T(E(n.prototype),"update",this).call(this,t)}},{key:"close",value:function(t){return T(E(n.prototype),"close",this).call(this,t)}},{key:"_attachHandlers",value:function(t){t.addEventListener("menu:close",this._handleClose.bind(this)),t.addEventListener("menu:add-worker",this._handleAddWorker.bind(this)),t.addEventListener("menu:remove-worker",this._handleRemoveWorker.bind(this)),t.addEventListener("menu:ability",this._handleAbility.bind(this))}},{key:"_detachHandlers",value:function(t){t.removeEventListener("menu:close",this._handleClose.bind(this)),t.removeEventListener("menu:add-worker",this._handleAddWorker.bind(this)),t.removeEventListener("menu:remove-worker",this._handleRemoveWorker.bind(this)),t.removeEventListener("menu:ability",this._handleAbility.bind(this))}},{key:"_handleClose",value:function(t){t.stopPropagation(),this.emit("tile:close",{state:this.getState()})}},{key:"_handleAddWorker",value:function(t){t.stopPropagation(),this.emit("building:add-worker",{building:this})}},{key:"_handleRemoveWorker",value:function(t){t.stopPropagation(),this.emit("building:remove-worker",{building:this})}},{key:"_handleAbility",value:function(t){t.stopPropagation(),this.emit("building:ability",{ability:t.detail})}}]),n}();function R(t){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function L(t,e,n){return(L="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=D(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function D(t){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function M(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function I(t,e,n){return e&&M(t.prototype,e),n&&M(t,n),t}function W(t,e){return(W=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Y=new(function(){function r(t){var e;!function(t){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this);var n=JSON.parse(JSON.stringify(r.info()));return(e=function(t,e){return!e||"object"!==R(e)&&"function"!=typeof e?function(){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():e}(this,D(r).call(this,Object.assign(n,t)))).menuItems=[C],e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&W(t,e)}(r,p),I(r,null,[{key:"info",value:function(){return{id:1,name:"Grass",component:"buildings-menu"}}}]),I(r,[{key:"open",value:function(t,e){return t.update(this.menuItems),L(D(r.prototype),"open",this).call(this,t,e)}},{key:"_attachHandlers",value:function(t){t.addEventListener("menu:close",this._handleClose.bind(this)),t.addEventListener("menu:build",this._handleBuild.bind(this))}},{key:"_detachHandlers",value:function(t){t.removeEventListener("menu:close",this._handleClose.bind(this)),t.removeEventListener("menu:build",this._handleBuild.bind(this))}},{key:"_handleClose",value:function(t){t.stopPropagation(),this.emit("tile:close",{state:this.getState()})}},{key:"_handleBuild",value:function(t){t.stopPropagation(),this.emit("tile:build",{Building:t.detail,state:this.getState()})}}]),r}())({debug:!0}),A=new C({debug:!0});function X(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var H=function(){function e(t){!function(t){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.layers=t.layers,this.rows=t.rows,this.cols=t.cols,this.stateMap=[],this.debug=t.debug||!1,this._initStates(),this.debug&&console.log("[STATE] created map (".concat(this.layers," x ").concat(this.cols," x ").concat(this.rows," cells)"))}return X(e.prototype,[{key:"_initStates",value:function(){for(var t=0,e=0,n=0;n<this.layers;n++)for(this.stateMap[n]=[],t=0;t<this.rows;t++)for(this.stateMap[n][t]=[],e=0;e<this.cols;e++)this.stateMap[n][t].push({layer:n,col:e,row:t})}},{key:"getTileState",value:function(t,e,n){return this.stateMap[t][n][e]}},{key:"setTileState",value:function(t,e,n,r){this.stateMap[e][r][n]=t}},{key:"save",value:function(){}},{key:"load",value:function(){}}]),e}();function z(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var U=r(window.console),B=function(){function e(t){!function(t){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.canvas=t.canvas,this.context=t.canvas.getContext("2d"),this.width=t.width,this.height=t.height,this.worldWidth=t.worldWidth,this.worldHeight=t.worldHeight,this.offsetX=t.startX||0,this.offsetY=t.startY||0,this.debug=t.debug||!1,this.canvas.style.zIndex="0",this.offsetX=Math.min(this.offsetX,this.worldWidth-this.width),this.offsetY=Math.min(this.offsetY,this.worldHeight-this.height),!this.debug||t.startX===this.offsetX&&t.startY===this.offsetY||U.log("[VIEWPORT] clamping starting position: ".concat(this.offsetX," | ").concat(this.offsetY))}return z(e.prototype,[{key:"move",value:function(t){var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(t,2),n=e[0],r=e[1];this.offsetX+=n,this.offsetY+=r,this.offsetX=Math.max(0,Math.min(this.worldWidth-this.width,this.offsetX)),this.offsetY=Math.max(0,Math.min(this.worldHeight-this.height,this.offsetY))}},{key:"draw",value:function(t){this.context.drawImage(t,this.offsetX,this.offsetY,this.width,this.height,0,0,this.width,this.height)}},{key:"clear",value:function(){this.context.clearRect(0,0,this.width,this.height)}},{key:"getRect",value:function(t){var e=0<arguments.length&&void 0!==t&&t;return e?[this.offsetX/e|0,(this.width+this.offsetX-1)/e|0,this.offsetY/e|0,(this.height+this.offsetY-1)/e|0]:[this.offsetX,this.offsetY,this.offsetX+this.width,this.offsetY+this.height]}},{key:"canvasToWorldPosition",value:function(t,e,n){var r=2<arguments.length&&void 0!==n&&n,o=t+this.offsetX,i=e+this.offsetY;return r?[o/r|0,i/r|0]:[o,i]}},{key:"worldToCanvasPosition",value:function(t,e,n){var r=2<arguments.length&&void 0!==n&&n,o=t-this.offsetX,i=e-this.offsetY;return r?[o/r|0,i/r|0]:[o,i]}},{key:"resize",value:function(t,e){this.debug&&U.throttle(1e3).log("[VIEWPORT] setting size: ".concat(t," x ").concat(e," px")),this.width=t,this.height=e,this.canvas.width=t,this.canvas.height=e,this.offsetX=Math.min(this.offsetX,this.worldWidth-this.width),this.offsetY=Math.min(this.offsetY,this.worldHeight-this.height)}}]),e}();function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function N(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var F=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};!function(t){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this._events=[],this.debug=t.debug||!1}return N(e.prototype,[{key:"add",value:function(t,e){this._events.push(function(o){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?q(i,!0).forEach(function(t){var e,n,r;e=o,r=i[n=t],n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(i)):q(i).forEach(function(t){Object.defineProperty(o,t,Object.getOwnPropertyDescriptor(i,t))})}return o}({},e,{name:t}))}},{key:"get",value:function(){return this._events.shift()}},{key:"find",value:function(t){return this._events.find(t)}},{key:"findAll",value:function(t){return this._events.filter(t)}}]),e}();function G(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function K(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var J=function(){function e(t){!function(t){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.level=t.level,this.tileMap=t.map,this.tileset=t.tileset,this.canvas=null,this.context=null,this.queue=new F,this._dirty=!0,this.selectedTile=null,this.debug=t.debug||!1}return K(e.prototype,[{key:"init",value:function(){var t=G(this.getSize(!0),2),e=t[0],n=t[1];this.canvas=document.createElement("canvas"),this.canvas.width=e,this.canvas.height=n,this.context=this.canvas.getContext("2d"),this.draw()}},{key:"draw",value:function(){if(this._dirty){this.debug&&console.log("[LAYER] [".concat(this.level,"] drawing (").concat(this.getSize(!0).join(" x ")," px, ").concat(this.getSize().join(" x ")," cells)"));var t=G(this.getSize(),2),e=t[0],n=t[1],r=G(this.tileset.getSize(),1)[0],o=this.tileset.tileSize,i=0,a=0,u=0,s=0,l=0,c=0;this.context.clearRect(0,0,this.canvas.width,this.canvas.height);for(var f=0;f<n;f++)for(i=0;i<e;i++)0<(a=this.getTileID(i,f))&&(u=i*o,s=f*o,l=(a-1)%r*o,c=((a-1)/r|0)*o,this.context.drawImage(this.tileset.canvas,l,c,o,o,u,s,o,o),null!==this.selectedTile&&this.selectedTile[0]===i&&this.selectedTile[1]===f&&(this.context.strokeStyle="orange",this.context.lineWidth=10,this.context.strokeRect(u+5,s+5,o-10,o-10),this.context.strokeStyle="white",this.context.lineWidth=1));this._dirty=!1}}},{key:"update",value:function(t,e){}},{key:"getSize",value:function(t){var e=0<arguments.length&&void 0!==t&&t;return[this.tileMap[0].length*(e?this.tileset.tileSize:1),this.tileMap.length*(e?this.tileset.tileSize:1)]}},{key:"getTileID",value:function(t,e){return this.tileMap[e][t]}},{key:"setTileID",value:function(t,e,n){this.tileMap[n][e]=t,this._dirty=!0}},{key:"setSelection",value:function(t,e){this.selectedTile=[t,e],this._dirty=!0}},{key:"clearSelection",value:function(){null!==this.selectedTile&&(this._dirty=!0),this.selectedTile=null}}]),e}();function V(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Q(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Z=function(){function e(t){!function(t){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.speed=t.speed,this.debug=t.debug||0}return Q(e.prototype,[{key:"getDirection",value:function(){}},{key:"isMoving",value:function(){var t=V(this.getDirection(),2),e=t[0],n=t[1];return 0!==e||0!==n}},{key:"getDistance",value:function(t){var e=V(this.getDirection(),2),n=e[0],r=e[1];return[n*t*this.speed|0,r*t*this.speed|0]}}]),e}();function $(t){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tt(t){return(tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function et(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function nt(t,e,n){return e&&et(t.prototype,e),n&&et(t,n),t}function rt(t,e){return(rt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ot=function(){function r(t){var e;!function(t){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this),e=function(t,e){return!e||"object"!==$(e)&&"function"!=typeof e?function(){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():e}(this,tt(r).call(this,t));var n=[r.LEFT,r.RIGHT,r.UP,r.DOWN];return e._keys={},e._initListeners(n),e.debug&&console.log("[KEYBOARD] listeners attached (".concat(n.join(" "),", keydown and keyup)")),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rt(t,e)}(r,Z),nt(r,null,[{key:"LEFT",get:function(){return 37}},{key:"UP",get:function(){return 38}},{key:"RIGHT",get:function(){return 39}},{key:"DOWN",get:function(){return 40}}]),nt(r,[{key:"_initListeners",value:function(t){var e=this;window.addEventListener("keydown",this._onKeyDown.bind(this)),window.addEventListener("keyup",this._onKeyUp.bind(this)),t.forEach(function(t){e._keys[t]=!1})}},{key:"_onKeyDown",value:function(t){var e=t.keyCode;e in this._keys&&(t.preventDefault(),this._keys[e]=!0)}},{key:"_onKeyUp",value:function(t){var e=t.keyCode;e in this._keys&&(t.preventDefault(),this._keys[e]=!1)}},{key:"_isDown",value:function(t){return t in this._keys?this._keys[t]:(this.debug&&console.warn("[KEYBOARD] requested status of keycode ".concat(t,", which we're not listening to")),!1)}},{key:"getDirection",value:function(){var t=0,e=0;return this._isDown(r.LEFT)&&(t=-1),this._isDown(r.RIGHT)&&(t=1),this._isDown(r.UP)&&(e=-1),this._isDown(r.DOWN)&&(e=1),[t,e]}}]),r}();function it(t){return(it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function at(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ut(t){return(ut=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function st(t,e){return(st=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var lt=function(){function n(t){var e;return function(t){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this),(e=function(t,e){return!e||"object"!==it(e)&&"function"!=typeof e?function(){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():e}(this,ut(n).call(this,t))).startX=-1,e.startY=-1,e.currX=-1,e.currY=-1,e.endX=-1,e.endY=-1,e._initListeners(),e.debug&&console.log("[TOUCH] listeners attached (touchstart, touchmove, touchend and touchcancel)"),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&st(t,e)}(n,Z),at(n.prototype,[{key:"_initListeners",value:function(){window.addEventListener("touchstart",this._onTouchStart.bind(this),{passive:!1}),window.addEventListener("touchmove",this._onTouchMove.bind(this),{passive:!1}),window.addEventListener("touchend",this._onTouchEnd.bind(this)),window.addEventListener("touchcancel",this._onTouchCancel.bind(this))}},{key:"_onTouchStart",value:function(t){this.startX=this.currX=t.touches[0].pageX-t.touches[0].target.offsetLeft,this.startY=this.currY=t.touches[0].pageY-t.touches[0].target.offsetTop}},{key:"_onTouchMove",value:function(t){this.currX=t.touches[0].pageX-t.touches[0].target.offsetLeft,this.currY=t.touches[0].pageY-t.touches[0].target.offsetTop}},{key:"_onTouchEnd",value:function(t){this.endX=this.currX=t.changedTouches[0].pageX-t.changedTouches[0].target.offsetLeft,this.endY=this.currY=t.changedTouches[0].pageY-t.changedTouches[0].target.offsetTop,this.startX=this.endX,this.startY=this.endY}},{key:"_onTouchCancel",value:function(t){this.endX=this.currX=t.changedTouches[0].pageX-t.changedTouches[0].target.offsetLeft,this.endY=this.currY=t.changedTouches[0].pageY-t.changedTouches[0].target.offsetTop,this.startX=this.endX,this.startY=this.endY}},{key:"getDirection",value:function(){var t=0,e=0,n=this.currX-this.startX,r=this.currY-this.startY;return 0<n&&(t=-1),n<0&&(t=1),0<r&&(e=-1),r<0&&(e=1),[t,e]}},{key:"getDistance",value:function(t){var e=this.startX-this.currX;this.startX=this.currX;var n=this.startY-this.currY;return this.startY=this.currY,[e,n]}}]),n}();function ct(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ft=function(){function e(t){!function(t){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.key=t.key,this.source=t.path,this.loader=t.loader,this.size=t.size,this.tileSize=t.tileSize,this.canvas=null,this.context=null,this.debug=t.debug||!1}return ct(e.prototype,[{key:"load",value:function(){var e=this;return this._initImage().then(function(t){return e._initCanvas(),t})}},{key:"_initImage",value:function(){return this.loader.loadImage(this.key,this.source)}},{key:"_initCanvas",value:function(){var t=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(this.getSize(!0),2),e=t[0],n=t[1],r=this.loader.getImage(this.key);this.canvas=document.createElement("canvas"),this.canvas.width=e,this.canvas.height=n,this.context=this.canvas.getContext("2d"),this.context.drawImage(r,0,0),this.debug&&console.log("[TILESET] [".concat(this.key,"] drawn (").concat(this.getSize(!0).join(" x ")," px, ").concat(this.getSize().join(" x ")," cells)"))}},{key:"getSize",value:function(t){var e=0<arguments.length&&void 0!==t&&t;return[this.size[0]*(e?this.tileSize:1),this.size[1]*(e?this.tileSize:1)]}}]),e}();function ht(t){return(ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function pt(t){return(pt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function vt(t,e){return(vt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var bt=function(){function c(t){var e,n,r;!function(t){if(!(t instanceof c))throw new TypeError("Cannot call a class as a function")}(this),(n=this,e=!(r=pt(c).call(this))||"object"!==ht(r)&&"function"!=typeof r?yt(n):r).element=t.element,e.components=t.components,e.currentTile=null,e.currentComponent=null,e.debug=t.debug||!1;var o=!0,i=!1,a=void 0;try{for(var u,s=e.components.values()[Symbol.iterator]();!(o=(u=s.next()).done);o=!0){var l=u.value;l.debug=e.debug,l.classList.add("hide"),e.element.appendChild(l)}}catch(t){i=!0,a=t}finally{try{o||null==s.return||s.return()}finally{if(i)throw a}}return e.element.style.zIndex="1",e.element.addEventListener("click",e._onClick.bind(yt(e)),!1),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vt(t,e)}(c,s),dt(c.prototype,[{key:"_onClick",value:function(t){t.preventDefault(),t.stopPropagation(),this.emit("ui:click",[t.layerX,t.layerY])}},{key:"isMounted",value:function(){return null!==this.currentTile&&null!==this.currentComponent}},{key:"open",value:function(t,e){return!(this.isMounted()||(this.components.has(t.component)?(this.debug&&console.log("[UI] mounting component:",t.name),this.currentComponent=this.components.get(t.component),this.currentTile=t,this.currentTile.on("tile:close",this._handleComponentClose,this),this.debug&&console.log("[UI] opening component:",this.currentTile.name),!this.currentTile.open(this.currentComponent,e)||(this.emit("ui:open",{tile:this.currentTile}),0)):(console.warn("[UI] component '".concat(t.component,"' not found")),1)))}},{key:"update",value:function(){this.currentTile.update(this.currentComponent)}},{key:"close",value:function(){if(!this.isMounted())return!1;this.debug&&console.log("[UI] closing component:",this.currentTile.name);var t=this.currentTile.close(this.currentComponent);return this.emit("ui:close",{state:t,tile:this.currentTile}),this.debug&&console.log("[UI] unmounting component:",this.currentTile.name),this.currentTile.off("tile:close",this._handleComponentClose,this),this.currentTile=null,!(this.currentComponent=null)}},{key:"_handleComponentClose",value:function(t){this.close()}}]),c}();function mt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var gt=function(){function e(t){!function(t){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this._images={},this.debug=t.debug||!1}return mt(e.prototype,[{key:"loadImage",value:function(n,r){var o=this,i=new window.Image,t=new Promise(function(t,e){i.addEventListener("load",function(){o.debug&&console.log("[LOADER] loaded image ".concat(r)),o._images[n]=i,t(n)}),i.addEventListener("error",function(){e(new Error("[LOADER] could not load image ".concat(r)))})});return i.src=r,t}},{key:"getImage",value:function(t){return t in this._images?this._images[t]:null}}]),e}();function wt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var _t=function(){function e(t){!function(t){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.container=t.container,this.debug=t.debug||!1,this.loader=new gt({debug:this.debug})}return wt(e.prototype,[{key:"load",value:function(){}},{key:"init",value:function(){}},{key:"update",value:function(t,e){}},{key:"draw",value:function(){}},{key:"resize",value:function(t,e){}}]),e}();function kt(t){return(kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ot(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function St(t){return(St=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tt(t,e){return(Tt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Et=function(){function n(t){var e;return function(t){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this),(e=function(t,e){return!e||"object"!==kt(e)&&"function"!=typeof e?function(){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():e}(this,St(n).call(this,t))).ui=t.ui,e.resources=t.resources||{food:100,wood:100,rock:100},e.population=t.population,e.workers=0,e.buildings=[],e.element=e._initHeader(),e.debug=t.debug||!1,e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tt(t,e)}(n,s),Ot(n.prototype,[{key:"_initHeader",value:function(){var t=this.ui.components.get("city-header");return t.init({resources:this.resources,workers:this.workers,population:this.population}),t.classList.remove("hide"),t}},{key:"build",value:function(t,e){var n=t.info().cost;if(this.spend(n)){var r=new t({debug:this.debug});return r.setState({layer:e[0],col:e[1],row:e[2]}),this.debug&&console.log("[CITY] building '".concat(r.name,"' in position ").concat(e[1]," | ").concat(e[2]," (").concat(e[0],")")),this.buildings.push(r),r}return!1}},{key:"production",value:function(a){var e=this.buildings.reduce(function(t,e){var n=e.produce(a);if(n)for(var r=0,o=Object.keys(n);r<o.length;r++){var i=o[r];t[i]+=n[i]}return t},{food:0,wood:0,rock:0});return 0<Object.keys(e).filter(function(t){return 0<e[t]}).length&&(this.debug&&console.log("[CITY] production:",e),this.gain(e)),e}},{key:"canAfford",value:function(t){for(var e=!0,n=0,r=Object.keys(t);n<r.length;n++){var o=r[n];if(this.resources[o]<t[o]){e=!1;break}}return e}},{key:"spend",value:function(t){if(!this.canAfford(t))return!1;for(var e=0,n=Object.keys(t);e<n.length;e++){var r=n[e];this.resources[r]-=t[r]}return this.updateHeader(),!0}},{key:"gain",value:function(t){for(var e=0,n=Object.keys(t);e<n.length;e++){var r=n[e];0<t[r]&&(this.resources[r]+=t[r])}this.updateHeader()}},{key:"getBuildingAt",value:function(e,n,r){var o=null;return this.buildings.find(function(t){return(o=t.getState()).layer===e&&o.col===n&&o.row===r})}},{key:"assignWorker",value:function(t){return!(this.population<=this.workers||!t.assignWorker()||(this.workers++,this.updateHeader(),0))}},{key:"removeWorker",value:function(t){return!!t.removeWorker()&&(this.workers--,this.updateHeader(),!0)}},{key:"updateHeader",value:function(){this.element.update({resources:this.resources,workers:this.workers,population:this.population})}}]),n}();function jt(t){return(jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function xt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Ct(o){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?xt(i,!0).forEach(function(t){var e,n,r;e=o,r=i[n=t],n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(i)):xt(i).forEach(function(t){Object.defineProperty(o,t,Object.getOwnPropertyDescriptor(i,t))})}return o}function Rt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Lt(t){return(Lt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Dt(t,e){return(Dt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Mt=r(window.console),It=function(){function i(t){var n;!function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(n=function(t,e){return!e||"object"!==jt(e)&&"function"!=typeof e?function(){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():e}(this,Lt(i).call(this,t))).map=se,n.tilesets=le.map(function(t){return new ft(Ct({},t,{loader:n.loader}))}),n.input=[new ot(fe),new lt(he)],n.state=new H(Ct({},de,{layers:n.map.length,rows:n.map[0].length,cols:n.map[0][0].length})),n.layers=n.map.map(function(t,e){return new J({debug:n.debug,level:e,map:t,tileset:n.tilesets[e]||n.tilesets[0]})});var e=Pt(n.layers[0].getSize(!0),2),r=e[0],o=e[1];return n.viewport=new B(Ct({},ce,{worldWidth:r,worldHeight:o})),n.ui=new bt(ve),n.tiles=pe,n.city=new Et({root:n.ui.element,population:5,resources:{food:100,wood:100,rock:100},ui:n.ui,debug:!0}),n.resize(n.viewport.width,n.viewport.height),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dt(t,e)}(i,_t),Rt(i.prototype,[{key:"load",value:function(){return this.tilesets.map(function(t){return t.load()})}},{key:"init",value:function(){window.addEventListener("resize",this._handleResize.bind(this)),this.layers.forEach(function(t){return t.init()}),this.ui.on("ui:click",this._handleUIClick,this),this.ui.on("ui:open",this._handleUIOpen,this),this.ui.on("ui:close",this._handleUIClose,this)}},{key:"update",value:function(e,n){var t=!0,r=!1,o=void 0;try{for(var i,a=this.input[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var u=i.value;if(u.isMoving()){this.viewport.move(u.getDistance(e));break}}}catch(t){r=!0,o=t}finally{try{t||null==a.return||a.return()}finally{if(r)throw o}}this.layers.forEach(function(t){return t.update(e,n)}),this.city.production(n)}},{key:"draw",value:function(){this.viewport.clear();for(var t=0;t<this.layers.length;t++)this.layers[t].draw(),this.viewport.draw(this.layers[t].canvas)}},{key:"resize",value:function(t,e){this.debug&&Mt.throttle(1e3).log("[WORLD] setting size: ".concat(t," x ").concat(e," px")),this.container.style.width="".concat(t,"px"),this.container.style.height="".concat(e,"px"),this.viewport.resize(t,e)}},{key:"_handleUIClick",value:function(t){for(var e=Pt(t,2),n=e[0],r=e[1],o=Pt(this.viewport.canvasToWorldPosition(n,r,this.tilesets[0].tileSize),2),i=o[0],a=o[1],u=0,s=null,l=this.layers.length-1;0<=l;l--)if(0<(u=this.layers[l].getTileID(i,a))){(s=this.city.getBuildingAt(l,i,a)||this.tiles.get(u))?(this.debug&&Mt.log("[WORLD] handling component for tile ".concat(u,", clicked at ").concat(i," | ").concat(a," (").concat(l,")")),this.ui.isMounted()&&this.ui.close(),this.ui.open(s,this.state.getTileState(l,i,a))):Mt.warn("[WORLD] no instance defined for tile ID ".concat(u));break}}},{key:"_handleUIOpen",value:function(t){var e=t.tile,n=e.getState();this.layers[n.layer].setSelection(n.col,n.row),e.on("tile:build",this._handleTileBuild,this),e.on("building:add-worker",this._handleBuildingAddWorker,this),e.on("building:remove-worker",this._handleBuildingRemoveWorker,this),e.on("building:ability",this._handleBuildingAbility,this)}},{key:"_handleUIClose",value:function(t){var e=t.tile,n=e.getState();this.layers[n.layer].clearSelection(),e.off("tile:build",this._handleTileBuild,this),e.off("building:add-worker",this._handleBuildingAddWorker,this),e.off("building:remove-worker",this._handleBuildingRemoveWorker,this),e.off("building:ability",this._handleBuildingAbility,this)}},{key:"_handleTileBuild",value:function(t){var e=t.Building,n=t.state,r=this.city.build(e,[n.layer,n.col,n.row]);if(r){var o=r.getState();this.state.setTileState(o,o.layer,o.col,o.row),this.layers[n.layer].setTileID(r.id,o.col,o.row),this.ui.close()}}},{key:"_handleBuildingAddWorker",value:function(t){var e=t.building;if(this.city.assignWorker(e)){this.debug&&Mt.log("[WORLD] assigned worker to building: ".concat(e.name));var n=e.getState();this.state.setTileState(n,n.layer,n.col,n.row),this.ui.update()}}},{key:"_handleBuildingRemoveWorker",value:function(t){var e=t.building;if(this.city.removeWorker(e)){this.debug&&Mt.log("[WORLD] removed worker from building: ".concat(e.name));var n=e.getState();this.state.setTileState(n,n.layer,n.col,n.row),this.ui.update()}}},{key:"_handleBuildingAbility",value:function(){}},{key:"_handleResize",value:function(){var t=Math.max(document.documentElement.clientWidth,window.innerWidth||0),e=Math.max(document.documentElement.clientHeight,window.innerHeight||0);this.resize(t,e)}}]),i}();function Wt(t){return(Wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function At(t){var r="function"==typeof Map?new Map:void 0;return(At=function(t){if(null===t||(e=t,-1===Function.toString.call(e).indexOf("[native code]")))return t;var e;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(t))return r.get(t);r.set(t,n)}function n(){return Xt(t,arguments,zt(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Ht(n,t)})(t)}function Xt(t,e,n){return(Xt=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&Ht(o,n.prototype),o}).apply(null,arguments)}function Ht(t,e){return(Ht=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function zt(t){return(zt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ut=function(){function e(){var t;return function(t){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),(t=function(t,e){return!e||"object"!==Wt(e)&&"function"!=typeof e?function(){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():e}(this,zt(e).call(this))).debug=!1,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ht(t,e)}(e,At(HTMLElement)),Yt(e.prototype,[{key:"init",value:function(t){}},{key:"update",value:function(t){}}]),e}();function Bt(t){return(Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Nt(t){return(Nt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ft(t,e){return(Ft=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Gt=function(){function n(){var t;!function(t){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this),(t=function(t,e){return!e||"object"!==Bt(e)&&"function"!=typeof e?function(){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():e}(this,Nt(n).call(this))).attachShadow({mode:"open"});var e=document.getElementById("city-header-template").content.cloneNode(!0);return t.shadowRoot.appendChild(e),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ft(t,e)}(n,Ut),qt(n.prototype,[{key:"init",value:function(t){for(var e=this.shadowRoot.querySelector(".resources");e.lastChild;)e.removeChild(e.lastChild);for(var n=0,r=Object.keys(t.resources);n<r.length;n++){var o=r[n],i=document.createElement("div");i.classList.add(o);var a=document.createElement("span");a.classList.add("icon"),a.innerText=o.charAt(0).toUpperCase(),i.appendChild(a);var u=document.createElement("span");u.classList.add("value"),u.innerText="".concat(t.resources[o]),i.appendChild(u),e.appendChild(i)}this.shadowRoot.querySelector(".population .workers").innerText=t.workers,this.shadowRoot.querySelector(".population .total").innerText=t.population}},{key:"update",value:function(t){for(var e=0,n=Object.keys(t.resources);e<n.length;e++){var r=n[e],o=this.shadowRoot.querySelector(".".concat(r," .value"));o?o.innerText="".concat(t.resources[r]):console.warn("[COMPONENT][resources-header] No UI element for resource ".concat(r,". Did you declare it with init() ?"))}this.shadowRoot.querySelector(".population .workers").innerText=t.workers,this.shadowRoot.querySelector(".population .total").innerText=t.population}}]),n}();try{window.customElements.define("city-header",Gt)}catch(t){console.error("Custom elements not supported by the browser!")}function Kt(t){return(Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Vt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Qt(t){return(Qt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zt(t,e){return(Zt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $t=function(){function n(){var t;!function(t){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this),(t=function(t,e){return!e||"object"!==Kt(e)&&"function"!=typeof e?function(){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():e}(this,Qt(n).call(this)))._handlers=new Map,t.attachShadow({mode:"open"});var e=document.getElementById("buildings-template").content.cloneNode(!0);return t.shadowRoot.appendChild(e),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zt(t,e)}(n,Ut),Vt(n.prototype,[{key:"init",value:function(t){var y=this;this._handlers.set(this.shadowRoot,function(t){return t.stopPropagation()}),this._handlers.set(this.shadowRoot.querySelector(".navigation .close"),function(t){y.debug&&console.log("[MENU][buildings] closing menu"),t.stopPropagation(),y.dispatchEvent(new CustomEvent("menu:close"))});for(var v=this.shadowRoot.querySelector(".menu .list");v.lastChild;)v.removeChild(v.lastChild);var e=!0,n=!1,r=void 0;try{for(var b,o=function(){var e=b.value,n=e.info(),t=document.createElement("li");t.classList.add("list-item");var r=document.createElement("div");r.classList.add("click","card"),y._handlers.set(r,function(t){y.debug&&console.log("[MENU][buildings] clicked building:",n.name),t.stopPropagation(),y.dispatchEvent(new CustomEvent("menu:build",{detail:e}))}),t.appendChild(r);var o=document.createElement("div");o.classList.add("card-header","size-3"),o.innerText=n.name,r.appendChild(o);var i=document.createElement("div");i.classList.add("card-body"),r.appendChild(i);var a=document.createElement("div");a.style.display="inline-block",a.style.width="128px",a.style.height="128px",a.style.background="url(".concat(n.icon.image,")"),a.style.backgroundPosition="".concat(n.icon.x,"px ").concat(n.icon.y,"px"),i.appendChild(a);var u=document.createElement("div");u.classList.add("card-footer"),r.appendChild(u);var s=document.createElement("div");s.classList.add("resources","invert"),u.appendChild(s);for(var l=0,c=Object.keys(n.cost);l<c.length;l++){var f=c[l],h=document.createElement("div");h.classList.add(f);var d=document.createElement("span");d.classList.add("icon"),d.innerText=f.charAt(0).toUpperCase(),h.appendChild(d);var p=document.createElement("span");p.classList.add("value","size-4"),p.innerText="".concat(n.cost[f]),h.appendChild(p),s.appendChild(h)}v.appendChild(t)},i=t[Symbol.iterator]();!(e=(b=i.next()).done);e=!0)o()}catch(t){n=!0,r=t}finally{try{e||null==i.return||i.return()}finally{if(n)throw r}}this._attachHandlers()}},{key:"update",value:function(t){this._detachHandlers(),this._handlers.clear(),this.init(t)}},{key:"_attachHandlers",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,o=this._handlers[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=Jt(r.value,2),a=i[0],u=i[1];a.addEventListener("click",u)}}catch(t){e=!0,n=t}finally{try{t||null==o.return||o.return()}finally{if(e)throw n}}}},{key:"_detachHandlers",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,o=this._handlers[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=Jt(r.value,2),a=i[0],u=i[1];a.removeEventListener("click",u)}}catch(t){e=!0,n=t}finally{try{t||null==o.return||o.return()}finally{if(e)throw n}}}}]),n}();try{window.customElements.define("buildings-menu",$t)}catch(t){console.error("Custom elements not supported by the browser!")}function te(t){return(te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ee(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ne(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function re(t){return(re=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function oe(t,e){return(oe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ie=function(){function n(){var t;!function(t){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this),(t=function(t,e){return!e||"object"!==te(e)&&"function"!=typeof e?function(){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():e}(this,re(n).call(this)))._handlers=new Map,t.attachShadow({mode:"open"});var e=document.getElementById("building-template").content.cloneNode(!0);return t.shadowRoot.appendChild(e),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oe(t,e)}(n,Ut),ne(n.prototype,[{key:"init",value:function(t){var o=this;this._handlers.set(this.shadowRoot,function(t){return t.stopPropagation()}),this._handlers.set(this.shadowRoot.querySelector(".navigation .close"),function(t){o.debug&&console.log("[MENU][building info] closing menu"),t.stopPropagation(),o.dispatchEvent(new CustomEvent("menu:close"))}),this.shadowRoot.querySelector(".title.name").innerText=t.name,this.shadowRoot.querySelector(".img.picture").src=t.picture,this.shadowRoot.querySelector(".content.description").innerText=t.description;for(var e=this.shadowRoot.querySelector(".info ul");e.lastChild;)e.removeChild(e.lastChild);var n=!0,r=!1,i=void 0;try{for(var a,u=t.information[Symbol.iterator]();!(n=(a=u.next()).done);n=!0){var s=a.value,l=document.createElement("li");l.innerText=s,e.appendChild(l)}}catch(t){r=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(r)throw i}}0===t.information.length?this.shadowRoot.querySelector(".row.info").classList.add("hide"):this.shadowRoot.querySelector(".row.info").classList.remove("hide");for(var c=this.shadowRoot.querySelector(".abilities .content");c.lastChild;)c.removeChild(c.lastChild);var f=!0,h=!1,d=void 0;try{for(var p,y=function(){var e=p.value,t=document.createElement("div");t.classList.add("item","click"),o._handlers.set(t,function(t){o.debug&&console.log("[MENU][building info] using ability: ".concat(e.name)),t.stopPropagation(),o.dispatchEvent(new CustomEvent("menu:ability",{detail:e}))});var n=document.createElement("img");n.src=e.icon,n.classList.add("icon"),t.appendChild(n);var r=document.createElement("span");r.innerText=e.text,r.classList.add("text"),t.appendChild(r),c.appendChild(t)},v=t.abilities[Symbol.iterator]();!(f=(p=v.next()).done);f=!0)y()}catch(t){h=!0,d=t}finally{try{f||null==v.return||v.return()}finally{if(h)throw d}}0===t.abilities.length?this.shadowRoot.querySelector(".abilities").classList.add("hide"):this.shadowRoot.querySelector(".abilities").classList.remove("hide"),0<t.maxWorkers&&(this._handlers.set(this.shadowRoot.querySelector(".workers .add"),function(t){o.debug&&console.log("[MENU][building info] adding worker"),t.stopPropagation(),o.dispatchEvent(new CustomEvent("menu:add-worker"))}),this.shadowRoot.querySelector(".workers .current").innerText=t.workers,this.shadowRoot.querySelector(".workers .max").innerText=t.maxWorkers,this._handlers.set(this.shadowRoot.querySelector(".workers .remove"),function(t){o.debug&&console.log("[MENU][building info] removing worker"),t.stopPropagation(),o.dispatchEvent(new CustomEvent("menu:remove-worker"))})),this._attachHandlers()}},{key:"update",value:function(t){this._detachHandlers(),this._handlers.clear(),this.init(t)}},{key:"_attachHandlers",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,o=this._handlers[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=ee(r.value,2),a=i[0],u=i[1];a.addEventListener("click",u)}}catch(t){e=!0,n=t}finally{try{t||null==o.return||o.return()}finally{if(e)throw n}}}},{key:"_detachHandlers",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,o=this._handlers[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var i=ee(r.value,2),a=i[0],u=i[1];a.removeEventListener("click",u)}}catch(t){e=!0,n=t}finally{try{t||null==o.return||o.return()}finally{if(e)throw n}}}}]),n}();try{window.customElements.define("building-panel",ie)}catch(t){console.error("Custom elements not supported by the browser!")}var ae=Math.max(document.documentElement.clientWidth,window.innerWidth||0),ue=Math.max(document.documentElement.clientHeight,window.innerHeight||0),se=[[[58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58],[58,76,76,76,74,73,1,1,1,38,38,38,3,3,4,58],[58,76,76,75,74,1,1,1,1,37,37,38,3,4,4,58],[58,76,75,74,73,1,1,1,1,1,37,37,38,38,37,58],[58,74,74,43,6,6,24,1,1,1,38,37,38,37,37,58],[58,73,1,1,1,1,5,1,1,1,37,37,37,38,38,58],[58,1,1,1,1,1,5,1,1,1,37,38,38,37,37,58],[58,1,1,1,1,1,27,6,6,25,1,38,37,37,38,58],[58,1,1,1,1,1,5,1,1,1,1,1,38,38,38,58],[58,1,1,1,1,1,5,1,1,1,1,1,1,37,37,58],[58,1,1,76,1,1,5,1,1,1,1,1,1,1,1,58],[58,1,1,1,1,1,41,6,6,6,6,25,1,1,1,58],[58,1,1,1,1,1,1,1,1,1,1,1,1,1,1,58],[58,22,22,1,1,1,1,1,1,1,1,1,1,1,1,58],[58,22,21,1,1,1,1,1,1,1,1,1,1,1,1,58],[58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,17,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,35,0,0,0,0,0,0,0,0,0],[0,0,0,62,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,15,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,33,0,0,0,0,0,0,0],[0,0,0,54,0,117,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,62,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,62,0,64,52,0,0,119,0,114,115,0,0,0,0],[0,0,0,63,0,0,0,0,0,0,0,0,101,83,0,0],[0,0,0,0,0,81,51,0,0,0,0,116,101,101,0,0],[0,0,0,0,0,99,81,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,53,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,72,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]],le=[{key:"tiles",path:"static/tileset.png",size:[18,7],tileSize:128}],ce={debug:!0,canvas:document.getElementById("canvas"),width:ae,height:ue,startX:ae/2|0,startY:ue/2|0},fe={debug:!0,speed:.512},he={debug:!0,speed:.512},de={debug:!0},pe=new Map([[1,Y],[112,A]]),ye=new Map([["city-header",document.createElement("city-header")],["buildings-menu",document.createElement("buildings-menu")],["building-panel",document.createElement("building-panel")]]),ve={debug:!0,element:document.getElementById("ui"),components:ye},be={debug:2,updateTimeStep:10,updateTimeMax:50,world:new It({debug:!0,container:document.getElementsByClassName("container")[0]})};new a(be).run().then(function(){console.log("[MAIN] game has started")}),window.state=function(t,e,n){var r=0<arguments.length&&void 0!==t?t:null,o=1<arguments.length&&void 0!==e?e:null,i=2<arguments.length&&void 0!==n?n:null;null!==r&&null!==o&&null!==i?console.log("[DUMP][state] tile",be.world.state.getTileState(r,o,i)):console.log("[DUMP][state] all",be.world.state.stateMap)},window.city=function(){console.log("[DUMP][city] buildings",be.world.city.buildings)}}],o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=1);
//# sourceMappingURL=app.min.js.map